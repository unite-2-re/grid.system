function t(t,r){const n=t.split(" "),o=e(n[0],(()=>r.clientWidth)),a=e(n[1],(()=>r.clientHeight));return new DOMPoint(o,a)}function e(t,e){return t.endsWith("%")?parseFloat(t)/100*e():parseFloat(t)}function r(t){return t?.offsetParent??t?.host}function n(t){const e=[];let n=t;for(;n;){const t=r(n);if(t&&t instanceof HTMLHtmlElement)break;(n=t)&&e.push(n)}return e}function o(t){let e=t;for(;e;){if("currentCSSZoom"in e){const t=e.currentCSSZoom;if("number"==typeof t)return 1*t}const t=getComputedStyle(e);if(t.zoom&&"normal"!==t.zoom)return 1*parseFloat(t.zoom);if(t.zoom&&"normal"!==t.zoom||"currentCSSZoom"in e)return 1;e=e?.offsetParent??e?.parentElement}return 1}function a(t,e=1e-6){return e>Math.abs(t.a-1)&&e>Math.abs(t.b)&&e>Math.abs(t.c)&&e>Math.abs(t.d-1)&&e>Math.abs(t.e)&&e>Math.abs(t.f)}function s(t){let e=new DOMMatrix,r=[t,...n(t)];for(const t of r){let r=O(t);if(!a(r)){const e=S(t),n=(new DOMMatrix).translate(e.x,e.y),o=(new DOMMatrix).translate(-e.x,-e.y);r=n.multiply(r).multiply(o)}let n=new DOMMatrix;if(t instanceof HTMLElement){const{offsetLeft:e,offsetTop:r}=t;let o=0,a=0;t.offsetParent instanceof HTMLElement&&(o=t?.offsetParent?.scrollLeft||0,a=t?.offsetParent?.scrollTop||0);const s=e-o||0,i=r-a||0;.001>Math.abs(i)&&.001>Math.abs(s)||(n=(new DOMMatrix).translate(s,i))}const s=o(t),i=(new DOMMatrix).scale(s);e=n.multiply(i).multiply(r).multiply(e)}return A.set(t,e),e}function i(t,e,r){return s(t).inverse().transformPoint(new DOMPoint(e,r))}function u(t,e,r){return s(t).transformPoint(new DOMPoint(e,r))}const c=new WeakMap,l=new WeakMap,f=(t,e)=>{if("computedStyleMap"in t){const r=t?.computedStyleMap();return r.get(e)?.value||0}{const r=getComputedStyle(t,"");return parseFloat(r.getPropertyValue(e)?.replace?.("px",""))||0}},d=(t,e)=>{if(!l.has(t)){const r=[],n=new ResizeObserver((t=>{for(const e of t)if(e.contentBoxSize){const t=e.contentBoxSize[0];t&&r.forEach((e=>e?.(t,n)))}}));e?.({inlineSize:t.clientWidth-(f(t,"padding-left")+f(t,"padding-right")),blockSize:t.clientHeight-(f(t,"padding-top")+f(t,"padding-bottom"))},n),l.set(t,r),n.observe(t,{box:"content-box"})}l.get(t)?.push(e)},m=(t,e)=>{if(!c.has(t)){const r=[],n=new ResizeObserver((t=>{for(const e of t)if(e.borderBoxSize){const t=e.borderBoxSize[0];t&&r.forEach((e=>e?.(t,n)))}}));e?.({inlineSize:t.offsetWidth,blockSize:t.offsetHeight},n),c.set(t,r),n.observe(t,{box:"border-box"})}c.get(t)?.push(e)},b=(t,e,r)=>{const n=new Set((e.split(",")||[e]).map((t=>t.trim()))),o=new MutationObserver(((t,e)=>{for(const o of t)o.attributeName&&n.has(o.attributeName)&&r(o,e)}));return o.observe(t,{attributeOldValue:1,attributes:1,attributeFilter:[...n]}),n.forEach((e=>{r({target:t,type:"attributes",attributeName:e,oldValue:t?.getAttribute?.(e)},o)})),o},M=(t,e,r,n)=>{const o=new Set((r.split(",")||[r]).map((t=>t.trim()))),a=new MutationObserver(((t,r)=>{for(const a of t)if("childList"==a.type){const t=Array.from(a.addedNodes)||[],s=Array.from(a.removedNodes)||[];t.push(...Array.from(a.addedNodes||[]).flatMap((t=>Array.from(t?.querySelectorAll?.(e)||[])))),s.push(...Array.from(a.removedNodes||[]).flatMap((t=>Array.from(t?.querySelectorAll?.(e)||[])))),[...Array.from(new Set(t).values())].filter((t=>t?.matches?.(e))).forEach((t=>{o.forEach((e=>{n({target:t,type:"attributes",attributeName:e,oldValue:t?.getAttribute?.(e)},r)}))}))}else a.target?.matches?.(e)&&a.attributeName&&o.has(a.attributeName)&&n(a,r)}));return a.observe(t,{attributeOldValue:1,childList:1,subtree:1,attributes:1,attributeFilter:[...o],characterData:1}),Array.from(t.querySelectorAll(e)).forEach((t=>{o.forEach((e=>{n({target:t,type:"attributes",attributeName:e,oldValue:t?.getAttribute?.(e)},a)}))})),a},g=(t,e="*",r=(t,e)=>{})=>{const n=new MutationObserver(((t,n)=>{for(const o of t)if("childList"==o.type){const t=Array.from(o.addedNodes)||[],a=Array.from(o.removedNodes)||[];t.push(...Array.from(o.addedNodes||[]).flatMap((t=>Array.from(t?.querySelectorAll?.(e)||[])))),a.push(...Array.from(o.removedNodes||[]).flatMap((t=>Array.from(t?.querySelectorAll?.(e)||[]))));const s=[...Array.from(new Set(t).values())].filter((t=>t?.matches?.(e))),i=[...Array.from(new Set(a).values())].filter((t=>t?.matches?.(e)));(s.length>0||i.length>0)&&r?.({type:o.type,target:o.target,attributeName:o.attributeName,attributeNamespace:o.attributeNamespace,nextSibling:o.nextSibling,oldValue:o.oldValue,previousSibling:o.previousSibling,addedNodes:s,removedNodes:i},n)}}));n.observe(t,{childList:1,subtree:1});const o=Array.from(t.querySelectorAll(e));return o.length>0&&r?.({addedNodes:o},n),n},y=(t,e)=>!!t?.matches?.(e)||!!t?.closest?.(e),p=(t,e)=>(t?.matches?.(e)?t:null)||t?.closest?.(e);class h{#t=document.documentElement;#e="*";constructor(t="*",e=document.documentElement){this.#t=e,this.#e=t}observeAttribute(t,e){return M(this.#t,this.#e,t,e)}observeNodes(t){return g(this.#t,this.#e,t)}get query(){return this.#t.querySelector(this.#e)}get queryAll(){return Array.from(this.#t.querySelectorAll(this.#e))}delegated(t,e,r){this.#t.addEventListener(t,(t=>{t.target.matches(this.#e)&&e(t)}),r)}directly(t,e,r){this.#t.addEventListener(t,(t=>{t.stopPropagation();const r=document.elementFromPoint(t.clientX,t.clientY),n=p(r,this.#e);if(n&&Array.from(document.elementsFromPoint(t.clientX,t.clientY)).indexOf(n)>=0)return e(t)}),r)}}const w=(t="*",e=document.documentElement)=>new h(t,e),O=t=>{if(t?.computedStyleMap){const e=t.computedStyleMap().get("transform"),r=e?.toMatrix?.();if(r)return r}else if(t){const e=getComputedStyle(t);return new DOMMatrix(e?.getPropertyValue?.("transform"))}return new DOMMatrix},S=e=>t(getComputedStyle(e).getPropertyValue("transform-origin")||"50% 50%",e),A=new WeakMap,x=()=>"currentCSSZoom"in document.documentElement?document.documentElement.currentCSSZoom||1:parseFloat(document.documentElement.style.getPropertyValue("--scaling"))||1;let v=x()||1;document.documentElement.addEventListener("scaling",(()=>{v=x()||1})),document.documentElement.addEventListener("resize",(()=>{v=x()||1})),document.documentElement.classList.contains("__exp-use-zoom")||document.documentElement.classList.add("__exp-use-zoom"),addEventListener("resize",(()=>{v=x()||1}));const C=()=>v||1,N=(t=1)=>(document.documentElement.style.setProperty("--scaling",t),document.documentElement.dispatchEvent(new CustomEvent("scaling",{detail:{zoom:t},bubbles:1,cancelable:1})),t),z=()=>null!=document.documentElement?.currentCSSZoom?1:C(),D=()=>null==document.documentElement?.currentCSSZoom?1:C();export{w as $$,y as MOC,p as MOCElement,N as changeZoom,u as convertPointFromNodeToPage,i as convertPointFromPageToNode,h as default,z as fixedClientZoom,o as getElementZoom,s as getNodeFullTransform,r as getOffsetParent,n as getOffsetParentChain,O as getTransform,S as getTransformOrigin,x as getZoom,a as isNearlyIdentity,b as observeAttribute,M as observeAttributeBySelector,m as observeBorderBox,g as observeBySelector,d as observeContentBox,e as parseLength,t as parseOrigin,A as transformationMatrixCache,D as unfixedClientZoom,C as zoomOf};
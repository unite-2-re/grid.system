const e=e=>"function"==typeof e?.[Symbol.iterator],t=(t,n,c=null)=>{const o=null==c||"object"!=typeof t&&"function"!=typeof t?t:t?.[c]??t;let r=[];n instanceof Set||n instanceof Map||Array.isArray(n)||e(n)?r=(o instanceof Set||o instanceof WeakSet?n?.values?.():n?.entries?.())||n:"object"!=typeof n&&"function"!=typeof n||(r=o instanceof Set||o instanceof WeakSet?Object.values(n):Object.entries(n));let a=[];Array.isArray(o)?a=o.entries():o instanceof Map||o instanceof WeakMap?a=o?.entries?.():o instanceof Set||o instanceof WeakSet?a=o?.values?.():"object"!=typeof o&&"function"!=typeof o||(a=Object.entries(o));const s=new Set(Array.from(r).map((e=>e?.[0]))),f=new Set(Array.from(a).map((e=>e?.[0]))),i=f?.difference?.(s);if(Array.isArray(o)){const e=o.filter(((e,t)=>!i.has(t)));o.splice(0,o.length),o.push(...e)}else if(o instanceof Map||o instanceof WeakMap)for(const e of i)o.delete(e);else if(o instanceof Set||o instanceof WeakSet)for(const e of i)o.delete(e);else if("function"==typeof o||"object"==typeof o)for(const e of i)delete o[e];return o},n=(n,c,o=null,r=0)=>{const a=null==o||"object"!=typeof n&&"function"!=typeof n?n:n?.[o]??n;let s=null;if(r&&t(a,c),c instanceof Set||c instanceof Map||Array.isArray(c)||e(c)?s=(a instanceof Set||a instanceof WeakSet?c?.values?.():c?.entries?.())||c:"object"!=typeof c&&"function"!=typeof c||(s=a instanceof Set||a instanceof WeakSet?Object.values(c):Object.entries(c)),a&&s){if(Array.isArray(a)){for(const[e,t]of s)a[e]=t;return 1}if(a instanceof Map||a instanceof WeakMap){for(const e of s)a.set(...e);return 1}if(a instanceof Set||a instanceof WeakSet){for(const e of s)a.add(...e);return 1}if("object"==typeof a||"function"==typeof a)return Object.assign(a,Object.fromEntries(s))}return null!=o?Reflect.set(n,o,c):"object"==typeof c||"function"==typeof c?Object.assign(n,c):void 0};class c{constructor(){}get(e,t,n){return Reflect.get(e,t,n)}construct(e,t,n){return Reflect.construct(e,t,n)}has(e,t){return Reflect.has(e,t)}apply(e,t,n){return Reflect.apply(e,t,n)}set(e,t,c){return n(e,c,t)}deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}const o=e=>new Proxy(e,new c),r=new WeakMap,a=(e,t)=>("function"==typeof t?((e,t)=>{r.has(e)||r.set(e,new WeakMap);const n=r.get(e);if(!n.has(t)){const c=t?.bind?.(e);n.set(t,c)}return n.get(t)})(e,t):t)??t;class s{subscribers;listeners;constructor(){this.subscribers=new Map,this.listeners=new Set}subscribe(e,t){t?this.subscribers.has(t)?this.subscribers.get(t)?.add?.(e):this.subscribers.set(t,new Set([e])):this.listeners.has(e)||this.listeners.add?.(e)}trigger(e,t=null,n){Array.from(this.subscribers.get(e)?.values?.()||[]).forEach((c=>c(t,e,n))),Array.from(this.listeners?.values?.()||[]).forEach((c=>c(t,e,n)))}}const f=new WeakMap,i=Symbol(),u=(e,t)=>{const n=e?.[i]??e;return f.has(n)||f.set(n,new s),t},l=e=>{const t="object"==typeof e||"function"==typeof e?e?.[i]??e:e;if(Array.isArray(t)){const e=e=>l(e);return t?.map?.(e)||Array.from(t||[]).map(e)}if(t instanceof Map||t instanceof WeakMap){const e=new Map;for(const n of t?.entries?.())e.set(n[0],l(n[1]));return e}if(t instanceof Set||t instanceof WeakSet){const e=new Set;for(const n of t?.values?.())e.add(l(n[0]));return e}if(null!=t&&"function"==typeof t||"object"==typeof t){const e={};for(const n of Object.entries(t||{}))e[n[0]]=l(n[1]);return e}return t},p=(e,t,c=()=>"")=>{w(t,((t,o)=>{o==c()&&n(e,t,null,1)}))},y=(e,t,c)=>(w(t,((t,c)=>{n(e,t,c,1)})),c?.((()=>e),(e=>{for(const c in e)n(t,e[c],c,1)}),{deep:1}),e),b=(e,t,n)=>y(t(l(e)),e,n),w=(e,t,n=null,c=null)=>{const o="object"==typeof e||"function"==typeof e?e?.[i]??e:e;n&&(o instanceof Map||o instanceof WeakMap||o instanceof Set||o instanceof WeakSet?!o.has(n)&&n||t?.(o.get(n),n):"function"!=typeof o&&"object"!=typeof o||t?.(Reflect.get(o,n,c??o),n));const r=f.get(o);return r?.subscribe?.(t,n),r};class S{constructor(){}has(e,t){return Reflect.has(e,t)}get(e,t,n){if(t==i)return e?.[i]??e;const c=a(e,Reflect.get(e,t,n));return"delete"==t?(t,n=null)=>{const o=e.get(t),r=c(t);return f.get(e)?.trigger?.(t,null,o),r}:"set"==t?(t,n)=>{const o=e.get(t),r=c(t,n);return f.get(e)?.trigger?.(t,n,o),r}:c}construct(e,t,n){return Reflect.construct(e,t,n)}apply(e,t,n){return Reflect.apply(e,t,n)}}class R{constructor(){}has(e,t){return Reflect.has(e,t)}get(e,t,n){if(t==i)return e?.[i]??e;const c=a(e,Reflect.get(e,t,n));return"delete"==t?t=>{const n=e.get(t),o=c(t);return f.get(e)?.trigger?.(t,null,n),o}:"add"==t?t=>{const n=e.get(t),o=c(t);return f.get(e)?.trigger?.(t,t,n),o}:c}construct(e,t,n){return Reflect.construct(e,t,n)}apply(e,t,n){return Reflect.apply(e,t,n)}}class j{constructor(){}get(e,t,n){return t==i?e?.[i]??e:a(e,Reflect.get(e,t,n))}construct(e,t,n){return Reflect.construct(e,t,n)}has(e,t){return Reflect.has(e,t)}apply(e,t,n){return Reflect.apply(e,t,n)}set(e,t,n){const c=e[t],o=Reflect.set(e,t,n),r=f.get(e);return r?.trigger?.(t,n,c),o}deleteProperty(e,t){const n=e[t],c=Reflect.deleteProperty(e,t),o=f.get(e);return o?.trigger?.(t,null,n),c}}const h=e=>new Proxy(e?.[i]??e,u(e,new j)),k=e=>new Proxy(e?.[i]??e,u(e,new S)),m=e=>new Proxy(e?.[i]??e,u(e,new R)),M=(e=[])=>new Proxy(new Map(e),u(e,new S)),W=(e=[])=>new Proxy(new Set(e),u(e,new R)),A=(e,t="")=>{const n="object"==typeof e||"function"==typeof e?e?.[i]??e:e;let c=e;return n instanceof Map||n instanceof WeakMap?c=k(e):n instanceof Set||n instanceof WeakSet?c=m(e):"function"!=typeof n&&"object"!=typeof n||(c=h(e)),c},d=(e,t="")=>{const n="object"==typeof e||"function"==typeof e?e?.[i]??e:e;let c=e;return Array.isArray(e)||"function"!=typeof n&&"object"!=typeof n||(c=h(e)),c},v=()=>crypto?.randomUUID?crypto?.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)));class g{#e=0;static looping=new Map([]);static registry=new FinalizationRegistry((e=>{g.looping.delete(e)}));constructor(){this.#e=0}available(e,t=()=>1){const n=performance.now();return n-this.#e>=e&&t()?(this.#e=n,1):0}static symbol(e=""){const t=Symbol(e||"switch");return document[t]=1,t}static async rafLoop(e,t=document){const n=v();try{g.looping.set(n,e)}catch(e){}if(null!=t)try{g?.registry?.register?.(t,n)}catch(e){}return 0}static get raf(){return new Promise((e=>requestAnimationFrame(e)))}static protect(e,t=100){return(new g).protect(e,t)}static cached(e,t=100){return(new g).cached(e,t)}cached(e,t=100){let n=null;return(...c)=>this.available(t)||null==n?n=e(...c):n}protect(e,t=100){return(...n)=>this.available(t)?e(...n):null}}const O=new g;(async()=>{for(;;)await Promise.allSettled(Array.from(g.looping.values()).map((e=>e?.(performance.now())))),await new Promise((e=>requestAnimationFrame(e)))})();export{c as AssignObjectHandler,S as ReactiveMap,j as ReactiveObject,R as ReactiveSet,s as Subscript,g as Time,v as UUIDv4,p as bindByKey,y as bindWith,d as createReactive,M as createReactiveMap,W as createReactiveSet,O as defaultTimer,b as derivate,i as extractSymbol,o as makeObjectAssignable,A as makeReactive,k as makeReactiveMap,h as makeReactiveObject,m as makeReactiveSet,n as objectAssign,t as removeExtra,l as safe,w as subscribe};